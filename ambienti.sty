\usepackage[framemethod=tikz]{mdframed}
\usepackage{tikz}
\usepackage{graphicx}

%AMBIENTE ESEMPIO

\mdfdefinestyle{esempio}{ 
  linewidth=0pt,
  linecolor=black,
  %backgroundcolor=gray!30,
  outerlinecolor=black,
  bottomline=false,rightline=false,topline=false,
  outerlinewidth=2pt,
  roundcorner=0pt,
  innertopmargin=2pt,
  innerbottommargin=5pt,
  skipabove=\topsep,
  skipbelow=\topsep,
  nobreak=false,
  frametitlefont=\bfseries\sffamily
  %frametitlealignment=\centering,
}

\newcounter{esempio}[chapter]
\renewcommand{\theesempio}{\thechapter.\arabic{esempio}}

\newenvironment{esempio}[1][]{%
  \refstepcounter{esempio}% Incrementa il contatore e permette il riferimento
  \ifstrempty{#1}
    {\mdfsetup{frametitle={Esempio \theesempio}}}
    {\mdfsetup{frametitle={Esempio \theesempio: #1}}}
  \begin{mdframed}[style=esempio]
}{%
  \end{mdframed}
}

\newcommand{\esref}[1]{{Es.\,\ref{#1}}}%riferimento all'esercizio

%AMBIENTE ESERCIZIO

\mdfdefinestyle{esercizio}{ 
  linewidth=0pt,
  linecolor=black,
  %backgroundcolor=gray!30,
  outerlinecolor=blue!80!cyan,
  bottomline=false,rightline=false,topline=false,
  outerlinewidth=2pt,
  roundcorner=0pt,
  innertopmargin=2pt,
  innerbottommargin=5pt,
  skipabove=\topsep,
  skipbelow=\topsep,
  nobreak=false,
  frametitlefont=\bfseries\sffamily
  %frametitlealignment=\centering,
}

\newcounter{esercizio}[chapter]
\renewcommand{\theesercizio}{\thechapter.\arabic{esercizio}}

\newenvironment{esercizio}[1][]{%
  \refstepcounter{esercizio}% Incrementa il contatore e permette il riferimento
  \ifstrempty{#1}
    {\mdfsetup{frametitle={Esercizio \theesercizio}}}
    {\mdfsetup{frametitle={Esercizio \theesercizio: #1}}}
  \begin{mdframed}[style=esercizio]
}{%
  \end{mdframed}
}

%AMBIENTE APPROFONDIMENTO

\mdfdefinestyle{approfondimento}{ 
  linewidth=0pt,
  linecolor=black,
  %backgroundcolor=orange!30!gray,
  outerlinecolor=teal,
  bottomline=false,rightline=false,topline=false,
  outerlinewidth=2pt,
  roundcorner=0pt,
  innertopmargin=2pt,
  innerbottommargin=5pt,
  skipabove=\topsep,
  skipbelow=\topsep,
  nobreak=false,
  frametitlefont=\bfseries\sffamily
  %frametitlealignment=\centering,
}

\newcounter{approfondimento}[chapter]
\renewcommand{\theapprofondimento}{\thechapter.\arabic{approfondimento}}

\newenvironment{approfondimento}[1][]{%
  \refstepcounter{approfondimento}% Incrementa il contatore e permette il riferimento
  \ifstrempty{#1}
    {\mdfsetup{frametitle={Approfondimento \theapprofondimento}}}
    {\mdfsetup{frametitle={Approfondimento \theapprofondimento: #1}}}
  \begin{mdframed}[style=approfondimento]
}{%
  \end{mdframed}
}
